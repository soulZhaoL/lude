# æ’é™¤å› å­é…ç½®ä¼˜åŒ– - å¯¹è¯è®°å½•ä¸æ”¹è¿›è®¡åˆ’

## å¯¹è¯èƒŒæ™¯

**æ—¶é—´**: 2025-08-01  
**é—®é¢˜æ ¸å¿ƒ**: æ’é™¤å› å­é…ç½®çš„åˆç†æ€§é—®é¢˜ï¼Œä¸»è¦æ¶‰åŠ `filter_factors_config.yaml` çš„å‚æ•°è®¾ç½®ç­–ç•¥

## å…³é”®é—®é¢˜è¯†åˆ«

### 1. ç”¨æˆ·å›é€€äº†ä¹‹å‰çš„é…ç½®å˜æ›´

ç”¨æˆ·è®¤ä¸ºä¹‹å‰çš„å˜æ›´æ–¹å‘ä¸å¯¹ï¼Œä¸»è¦åŸå› ï¼š

- value_options è¿‡äºå¯†é›†çš„æ‹…å¿§å¯èƒ½æ˜¯è¯¯åˆ¤
- è®¾ç½®è¿‡å¤šæ’é™¤å› å­å¯¼è‡´è¿‡åº¦è¿‡æ»¤ï¼Œæ˜¯è¿‡æ‹Ÿåˆçš„ä¸»è¦åŸå› 
- ç±»ä¼¼ `theory_conv_prem >= 1.0` çš„æ¡ä»¶ä¼šæ’é™¤æ‰ç»å¤§å¤šæ•°æ ‡çš„

### 2. ç”¨æˆ·çš„æ ¸å¿ƒæ´å¯Ÿ

1. **å•æ¡ä»¶+å¯†é›†é€‰é¡¹çš„åˆç†æ€§**: å¦‚æœ `max_conditions: 1`ï¼Œå¯†é›†çš„ value_options åè€Œèƒ½è®©ä¼˜åŒ–ç®—æ³•æ‰¾åˆ°æ›´ç²¾å‡†çš„é˜ˆå€¼
2. **è¿‡åº¦è¿‡æ»¤çš„è‡´å‘½é—®é¢˜**: å¤´éƒ¨/å°¾éƒ¨çš„æç«¯é˜ˆå€¼ä¼šæŠŠ99%çš„æ ‡çš„æ’é™¤ï¼Œå¯¼è‡´æ— å€™é€‰æ ‡çš„
3. **å¼‚å¸¸æ£€æµ‹æ€è·¯**: æ’é™¤å› å­åº”è¯¥ç”¨äºæ•°æ®æ¸…æ´—ï¼Œç±»ä¼¼å¼‚å¸¸æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç­–ç•¥é€‰æ‹©

## åˆ†æå¸ˆåé¦ˆè¦ç‚¹

### âœ… ç”¨æˆ·è¯´å¯¹çš„åœ°æ–¹

1. **å•æ¡ä»¶ç­–ç•¥æ­£ç¡®**: `max_conditions: 1` + å¯†é›† value_options ç¡®å®æ¯”ç²—ç³™åˆ†å‰²æ›´ä¼˜
2. **è¿‡åº¦è¿‡æ»¤è¯†åˆ«å‡†ç¡®**: `theory_conv_prem >= 1.0` ç­‰æ¡ä»¶ç¡®å®ä¼šè¿‡åº¦æ’é™¤æ ‡çš„
3. **å¼‚å¸¸æ£€æµ‹æ–¹å‘æ­£ç¡®**: æ’é™¤å› å­ä¸»è¦ç”¨äºæ•°æ®æ¸…æ´—è€Œéç­–ç•¥é€‰æ‹©

### ğŸš¨ æŒ‡å‡ºçš„ç›²ç‚¹å’Œé—®é¢˜

#### 1. æ•°æ®åˆ†å¸ƒè®¤çŸ¥ä¸è¶³

- ç”¨æˆ·æåˆ°"å¼‚å¸¸æ£€æµ‹"ä½†ç¼ºä¹å¯¹å„å› å­å®é™…åˆ†å¸ƒçš„äº†è§£
- éœ€è¦äº†è§£æ¯ä¸ªå› å­çš„æ­£å¸¸èŒƒå›´ã€å‡å€¼ã€æ ‡å‡†å·®ã€åˆ†ä½æ•°ç­‰åŸºç¡€ç»Ÿè®¡ç‰¹å¾
- ç¼ºä¹åŸºäº3ÏƒåŸåˆ™æˆ–IQRæ–¹æ³•çš„å¼‚å¸¸å€¼è¾¹ç•Œè®¾å®š

#### 2. ä¸šåŠ¡é€»è¾‘éªŒè¯ç¼ºå¤±

å¼‚å¸¸æ£€æµ‹ä¸èƒ½çº¯ç»Ÿè®¡ï¼Œéœ€è¦ç»“åˆä¸šåŠ¡é€»è¾‘ï¼š

- `left_years < 0.1`: ç»Ÿè®¡æ­£å¸¸ä½†ä¸šåŠ¡æ— æ„ä¹‰
- `amount < 500`: å¼‚å¸¸æµåŠ¨æ€§é£é™©ä¿¡å·
- `conv_prem > 2.0`: ç»Ÿè®¡å­˜åœ¨ä½†æŠ•èµ„æ— ä»·å€¼

## å½“å‰é…ç½®çŠ¶æ€

å½“å‰ `filter_factors_config.yaml` ä¸­æ¿€æ´»çš„æ’é™¤å› å­ï¼š

- `turnover`: æ¢æ‰‹ç‡ (10ä¸ªé€‰é¡¹: 0.001~1.5)
- `conv_prem`: è½¬è‚¡æº¢ä»·ç‡ (6ä¸ªé€‰é¡¹: -0.4~0.6)
- `pct_chg`: æ¶¨è·Œå¹… (6ä¸ªé€‰é¡¹: -0.6~1.0)
- `pct_chg_5`: 5æ—¥æ¶¨è·Œå¹… (5ä¸ªé€‰é¡¹: -0.3~1.0)
- `pct_chg_5_stk`: æ­£è‚¡5æ—¥æ¶¨è·Œå¹… (5ä¸ªé€‰é¡¹: -0.3~1.0)
- `bias_5`: 5æ—¥ä¹–ç¦»ç‡ (10ä¸ªé€‰é¡¹: -0.01~0.01)
- `close_ma_5`: 5æ—¥å‡ä»· (5ä¸ªé€‰é¡¹: 100~190)
- `alpha_pct_chg_5`: 5æ—¥è¶…é¢æ¶¨è·Œå¹… (6ä¸ªé€‰é¡¹: -0.02~0.03)
- `turnover_5`: 5æ—¥æ¢æ‰‹ç‡ (9ä¸ªé€‰é¡¹: 0.03~0.5)
- `theory_conv_prem`: ç†è®ºæº¢ä»·ç‡ (9ä¸ªé€‰é¡¹: -0.3~1.0)
- `mod_conv_prem`: ä¿®æ­£æº¢ä»·ç‡ (8ä¸ªé€‰é¡¹: -0.2~0.8)
- `bond_prem`: çº¯å€ºæº¢ä»·ç‡ (8ä¸ªé€‰é¡¹: -0.4~2.0)
- `ytm`: åˆ°æœŸæ”¶ç›Šç‡ (8ä¸ªé€‰é¡¹: -0.05~0.3)
- `theory_bias`: ç†è®ºåç¦»åº¦ (7ä¸ªé€‰é¡¹: -0.2~0.5)
- `pure_value`: çº¯å€ºä»·å€¼ (7ä¸ªé€‰é¡¹: 70~150)
- `theory_value`: ç†è®ºä»·å€¼ (5ä¸ªé€‰é¡¹: 90~150)
- `conv_value`: è½¬è‚¡ä»·å€¼ (5ä¸ªé€‰é¡¹: 80~160)
- `option_value`: æœŸæƒä»·å€¼ (5ä¸ªé€‰é¡¹: 2~80)
- `issue_size`: å‘è¡Œè§„æ¨¡ (5ä¸ªé€‰é¡¹: 10~200)

æ€»è®¡ï¼š19ä¸ªæ¿€æ´»å› å­ï¼Œcombination_rules é™åˆ¶æœ€å¤š3ä¸ªå› å­ç»„åˆã€‚

## æ”¹è¿›è®¡åˆ’

### ğŸ¯ ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®æ¢ç´¢ä¸åˆ†å¸ƒåˆ†æ (ä¼˜å…ˆçº§ï¼šé«˜)

#### 1.1 åŸºç¡€ç»Ÿè®¡åˆ†æ

```bash
# æ‰§è¡Œæ•°æ®åˆ†å¸ƒåˆ†æ
source ~/miniconda3/etc/profile.d/conda.sh && conda activate lude && python -c "
import pandas as pd
import numpy as np
from lude.config.paths import PARQUET_DATA_PATH

# è¯»å–æ•°æ®
df = pd.read_parquet(PARQUET_DATA_PATH)

# å½“å‰æ¿€æ´»çš„æ’é™¤å› å­åˆ—è¡¨
active_factors = [
    'turnover', 'conv_prem', 'pct_chg', 'pct_chg_5', 'pct_chg_5_stk',
    'bias_5', 'close_ma_5', 'alpha_pct_chg_5', 'turnover_5',
    'theory_conv_prem', 'mod_conv_prem', 'bond_prem', 'ytm',
    'theory_bias', 'pure_value', 'theory_value', 'conv_value',
    'option_value', 'issue_size'
]

# ç»Ÿè®¡åˆ†æ
print('=== æ’é™¤å› å­æ•°æ®åˆ†å¸ƒåˆ†æ ===')
for factor in active_factors:
    if factor in df.columns:
        series = df[factor].dropna()
        print(f'\n{factor}:')
        print(f'  æ ·æœ¬æ•°: {len(series)}')
        print(f'  å‡å€¼: {series.mean():.4f}, æ ‡å‡†å·®: {series.std():.4f}')
        print(f'  æœ€å°å€¼: {series.min():.4f}, æœ€å¤§å€¼: {series.max():.4f}')
        print(f'  åˆ†ä½æ•°: 1%={series.quantile(0.01):.4f}, 5%={series.quantile(0.05):.4f}, 95%={series.quantile(0.95):.4f}, 99%={series.quantile(0.99):.4f}')
        
        # å¼‚å¸¸å€¼æ£€æµ‹ (3ÏƒåŸåˆ™)
        mean_val = series.mean()
        std_val = series.std()
        outlier_lower = mean_val - 3 * std_val
        outlier_upper = mean_val + 3 * std_val
        outlier_count = len(series[(series < outlier_lower) | (series > outlier_upper)])
        print(f'  3Ïƒå¼‚å¸¸å€¼è¾¹ç•Œ: [{outlier_lower:.4f}, {outlier_upper:.4f}], å¼‚å¸¸å€¼æ•°é‡: {outlier_count} ({outlier_count/len(series)*100:.2f}%)')
    else:
        print(f'{factor}: åˆ—ä¸å­˜åœ¨')
"
```

#### 1.2 ä¸šåŠ¡é€»è¾‘å¼‚å¸¸å€¼å®šä¹‰

åŸºäºå¯è½¬å€ºæŠ•èµ„é€»è¾‘ï¼Œå®šä¹‰å„å› å­çš„ä¸šåŠ¡å¼‚å¸¸è¾¹ç•Œï¼š

**ä»·æ ¼ç±»å› å­**:

- `close_ma_5`: < 70 æˆ– > 300 (ä»·æ ¼å¼‚å¸¸)
- `conv_value`, `theory_value`, `pure_value`: < 50 æˆ– > 500 (ä»·å€¼å¼‚å¸¸)

**æº¢ä»·ç‡ç±»å› å­**:

- `theory_conv_prem`, `mod_conv_prem`: < -0.5 æˆ– > 3.0 (æº¢ä»·å¼‚å¸¸)
- `bond_prem`: < -0.8 æˆ– > 5.0 (çº¯å€ºæº¢ä»·å¼‚å¸¸)

**æµåŠ¨æ€§ç±»å› å­**:

- `turnover`, `turnover_5`: < 0.0001 æˆ– > 5.0 (æ¢æ‰‹ç‡å¼‚å¸¸)
- `issue_size`: < 5 æˆ– > 1000 (è§„æ¨¡å¼‚å¸¸)

**æ”¶ç›Šç‡ç±»å› å­**:

- `ytm`: < -0.2 æˆ– > 1.0 (æ”¶ç›Šç‡å¼‚å¸¸)
- `pct_chg`, `pct_chg_5`, `pct_chg_5_stk`: < -0.8 æˆ– > 3.0 (æ¶¨è·Œå¹…å¼‚å¸¸)

### ğŸ¯ ç¬¬äºŒé˜¶æ®µï¼šé…ç½®ä¼˜åŒ–ä¸éªŒè¯ (ä¼˜å…ˆçº§ï¼šé«˜)

#### 2.1 åŸºäºåˆ†å¸ƒçš„å¼‚å¸¸æ£€æµ‹é…ç½®

æ ¹æ®ç¬¬ä¸€é˜¶æ®µçš„åˆ†æç»“æœï¼Œé‡æ–°è®¾è®¡ value_optionsï¼š

- ä½¿ç”¨ [1%åˆ†ä½æ•°, 5%åˆ†ä½æ•°, 95%åˆ†ä½æ•°, 99%åˆ†ä½æ•°] ä½œä¸ºå¼‚å¸¸æ£€æµ‹è¾¹ç•Œ
- ç»“åˆä¸šåŠ¡é€»è¾‘è¾¹ç•Œè¿›è¡Œä¿®æ­£
- ç¡®ä¿æ¯ä¸ªé˜ˆå€¼éƒ½æœ‰å®é™…çš„è¿‡æ»¤æ„ä¹‰

#### 2.2 è¿‡æ»¤æ•ˆæœéªŒè¯

```bash
# éªŒè¯å„é˜ˆå€¼çš„è¿‡æ»¤æ•ˆæœ
source ~/miniconda3/etc/profile.d/conda.sh && conda activate lude && python -c "
# æµ‹è¯•å„ä¸ªé˜ˆå€¼çš„æ•°æ®ä¿ç•™æ¯”ä¾‹
# ç¡®ä¿æ²¡æœ‰é˜ˆå€¼ä¼šè¿‡åº¦è¿‡æ»¤ï¼ˆå¦‚ä¿ç•™ç‡ < 5%ï¼‰
"
```

#### 2.3 å› å­é‡è¦æ€§è¯„ä¼°

- åˆ†æå“ªäº›æ’é™¤å› å­å¯¹æœ€ç»ˆæ€§èƒ½å½±å“æœ€å¤§
- è€ƒè™‘å‡å°‘ä½ä»·å€¼å› å­ï¼Œé™ä½ç»„åˆå¤æ‚åº¦
- é‡ç‚¹ä¿ç•™é«˜ä»·å€¼çš„æ•°æ®æ¸…æ´—å› å­

### ğŸ¯ ç¬¬ä¸‰é˜¶æ®µï¼šç³»ç»Ÿæ€§æµ‹è¯•ä¸ä¼˜åŒ– (ä¼˜å…ˆçº§ï¼šä¸­)

#### 3.1 A/Bæµ‹è¯•æ¡†æ¶

- å¯¹æ¯”å½“å‰é…ç½® vs ä¼˜åŒ–åé…ç½®çš„æ€§èƒ½è¡¨ç°
- ä½¿ç”¨ç›¸åŒçš„ä¼˜åŒ–å‚æ•°è¿›è¡Œå…¬å¹³æ¯”è¾ƒ
- å…³æ³¨CAGRã€å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤ç­‰å…³é”®æŒ‡æ ‡

#### 3.2 è¿‡æ‹Ÿåˆé£é™©è¯„ä¼°

- åœ¨ä¸åŒæ—¶é—´çª—å£æµ‹è¯•é…ç½®ç¨³å®šæ€§
- åˆ†ææ’é™¤å› å­æ•°é‡ä¸æ€§èƒ½çš„å…³ç³»
- å»ºç«‹è¿‡æ‹Ÿåˆé¢„è­¦æœºåˆ¶

### ğŸ¯ ç¬¬å››é˜¶æ®µï¼šæ–‡æ¡£ä¸æµç¨‹æ ‡å‡†åŒ– (ä¼˜å…ˆçº§ï¼šä½)

#### 4.1 æ’é™¤å› å­è®¾è®¡åŸåˆ™æ–‡æ¡£åŒ–

- å¼‚å¸¸æ£€æµ‹ vs ç­–ç•¥é€‰æ‹©çš„è¾¹ç•Œ
- å„ç±»å› å­çš„ä¸šåŠ¡é€»è¾‘çº¦æŸ
- é˜ˆå€¼è®¾å®šçš„ç»Ÿè®¡å­¦åŸåˆ™

#### 4.2 é…ç½®ç®¡ç†æµç¨‹

- å»ºç«‹é…ç½®å˜æ›´çš„éªŒè¯æµç¨‹
- è‡ªåŠ¨åŒ–çš„é…ç½®åˆç†æ€§æ£€æŸ¥
- ç‰ˆæœ¬åŒ–ç®¡ç†ä¸å›æ»šæœºåˆ¶

## æ‰§è¡Œè®¡åˆ’æ—¶é—´çº¿

### ç«‹å³æ‰§è¡Œ (ä¸‹æ¬¡å¯¹è¯é‡ç‚¹)

1. **æ•°æ®åˆ†å¸ƒåˆ†æ** - è¿è¡ŒåŸºç¡€ç»Ÿè®¡åˆ†æè„šæœ¬ï¼Œäº†è§£å„å› å­çœŸå®åˆ†å¸ƒ
2. **å¼‚å¸¸è¾¹ç•Œè¯†åˆ«** - åŸºäºåˆ†ä½æ•°å’Œä¸šåŠ¡é€»è¾‘ç¡®å®šåˆç†çš„å¼‚å¸¸æ£€æµ‹é˜ˆå€¼
3. **è¿‡æ»¤æ•ˆæœé¢„ä¼°** - è¯„ä¼°æ–°é˜ˆå€¼çš„æ•°æ®ä¿ç•™ç‡ï¼Œé¿å…è¿‡åº¦è¿‡æ»¤

### çŸ­æœŸæ‰§è¡Œ (1-2å¤©å†…)

1. **é…ç½®æ–‡ä»¶é‡æ„** - åŸºäºåˆ†æç»“æœæ›´æ–° `filter_factors_config.yaml`
2. **éªŒè¯æµ‹è¯•** - å°è§„æ¨¡æµ‹è¯•æ–°é…ç½®çš„ä¼˜åŒ–æ•ˆæœ
3. **æ€§èƒ½å¯¹æ¯”** - ä¸å½“å‰é…ç½®è¿›è¡ŒA/Bå¯¹æ¯”

### ä¸­æœŸæ‰§è¡Œ (1å‘¨å†…)

1. **å…¨é¢æµ‹è¯•** - åœ¨å®Œæ•´æ•°æ®é›†ä¸Šæµ‹è¯•æ–°é…ç½®
2. **ç¨³å®šæ€§éªŒè¯** - å¤šæ—¶é—´çª—å£çš„é²æ£’æ€§æµ‹è¯•
3. **æ–‡æ¡£æ›´æ–°** - æ›´æ–°é…ç½®æ–‡ä»¶æ³¨é‡Šå’Œè®¾è®¡æ–‡æ¡£

## å…³é”®é£é™©æé†’

### âš ï¸ æ•°æ®è´¨é‡é£é™©

- ç¡®ä¿ç»Ÿè®¡åˆ†æä½¿ç”¨çš„æ˜¯å®Œæ•´ã€å‡†ç¡®çš„æ•°æ®é›†
- æ³¨æ„å¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼å¯¹ç»Ÿè®¡ç»“æœçš„å½±å“

### âš ï¸ è¿‡åº¦ä¼˜åŒ–é£é™©

- é¿å…åŸºäºå•ä¸€æ—¶é—´æ®µçš„æ•°æ®è¿‡åº¦è°ƒä¼˜
- ä¿æŒå¼‚å¸¸æ£€æµ‹çš„é€šç”¨æ€§ï¼Œä¸è¦è¿‡äºé’ˆå¯¹ç‰¹å®šå¸‚åœºç¯å¢ƒ

### âš ï¸ ä¸šåŠ¡é€»è¾‘é£é™©

- ç»Ÿè®¡å¼‚å¸¸ä¸ç­‰äºä¸šåŠ¡å¼‚å¸¸ï¼Œéœ€è¦é¢†åŸŸä¸“å®¶éªŒè¯
- æŸäº›"å¼‚å¸¸"å¯èƒ½æ˜¯é‡è¦çš„æŠ•èµ„æœºä¼šä¿¡å·

## æˆåŠŸæ ‡å‡†

### å®šé‡æŒ‡æ ‡

1. **æ•°æ®ä¿ç•™ç‡**: æ¯ä¸ªé˜ˆå€¼çš„æ•°æ®ä¿ç•™ç‡åœ¨10%-90%ä¹‹é—´
2. **CAGRæå‡**: ç›¸æ¯”å½“å‰é…ç½®ï¼ŒCAGRæå‡è‡³å°‘5%
3. **ç¨³å®šæ€§**: åœ¨ä¸åŒæ—¶é—´çª—å£çš„æ€§èƒ½æ³¢åŠ¨ < 20%

### å®šæ€§æŒ‡æ ‡

1. **é€»è¾‘åˆç†æ€§**: æ‰€æœ‰é˜ˆå€¼éƒ½æœ‰æ˜ç¡®çš„ä¸šåŠ¡é€»è¾‘æ”¯æ’‘
2. **å¯è§£é‡Šæ€§**: é…ç½®å‚æ•°èƒ½å¤Ÿå‘ä¸šåŠ¡äººå‘˜æ¸…æ™°è§£é‡Š
3. **ç»´æŠ¤æ€§**: é…ç½®æ›´æ–°æµç¨‹æ ‡å‡†åŒ–ï¼Œä¾¿äºåç»­è°ƒæ•´

---

**ä¸‹æ¬¡å¯¹è¯é‡ç‚¹**: é¦–å…ˆæ‰§è¡Œæ•°æ®åˆ†å¸ƒåˆ†æï¼ŒåŸºäºçœŸå®æ•°æ®åˆ¶å®šå¼‚å¸¸æ£€æµ‹ç­–ç•¥ï¼